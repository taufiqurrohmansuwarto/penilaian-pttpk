generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["filterJson"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model users {
  custom_id           String                @id
  username            String?
  image               String?
  id                  String?
  from                String?
  role                String?
  group               String?
  employee_number     String?
  acc_kinerja_bulanan acc_kinerja_bulanan[]
}

model acc_kinerja_bulanan {
  id_penilaian  Int
  bulan         Int        @db.SmallInt
  tahun         Int        @db.SmallInt
  sudah_verif   Boolean?   @default(false)
  diverif_oleh  String?
  custom_id_ptt String
  created_at    DateTime?  @default(now()) @db.Timestamp(6)
  updated_at    DateTime?  @db.Timestamp(6)
  penilaian     penilaian? @relation(fields: [id_penilaian], references: [id], onDelete: Cascade)
  user_ptt      users      @relation(fields: [custom_id_ptt], references: [custom_id], onDelete: Cascade, onUpdate: Cascade)

  @@id([id_penilaian, bulan, tahun ])
}

model kinerja_bulanan {
  id                  Int               @id @default(autoincrement())
  id_penilaian        Int?
  id_target_penilaian Int?
  title               String?
  bulan               Int?              @db.SmallInt
  tahun               Int?              @db.SmallInt
  id_ptt              Int?
  kuantitas           Int?
  kualitas            Int?              @default(0)
  start               DateTime?         @db.Timestamp(6)
  end                 DateTime?         @db.Timestamp(6)
  created_at          DateTime?         @default(now()) @db.Timestamp(6)
  updated_at          DateTime?         @db.Timestamp(6)
  penilaian           penilaian?        @relation(fields: [id_penilaian], references: [id], onDelete: Cascade)
  target_penilaian    target_penilaian? @relation(fields: [id_target_penilaian], references: [id], onDelete: Cascade)
}

model penilaian {
  id                  Int                   @id @default(autoincrement())
  id_ptt              Int?
  tahun               Int?                  @db.SmallInt
  id_skpd             String?               @db.VarChar(200)
  skpd                Json?
  id_jabatan          String?               @db.VarChar(200)
  jabatan             Json?
  aktif               Boolean?              @default(false)
  sudah_verif         Boolean?              @default(false)
  diverif_oleh        String?               @db.VarChar(200)
  awal_periode        DateTime              @db.Date
  akhir_periode       DateTime              @db.Date
  nip_atasan_langsung String?               @db.VarChar(200)
  atasan_langsung     Json?
  nip_atasan_banding  String?               @db.VarChar(200)
  atasan_banding      Json?
  nip_eselon_ii       String?               @db.VarChar(200)
  eselon_ii           Json?
  created_at          DateTime?             @default(now()) @db.Timestamp(6)
  updated_at          DateTime?             @db.Timestamp(6)
  pekerjaan_tambahan  String[]
  acc_kinerja_bulanan acc_kinerja_bulanan[]
  kinerja_bulanan     kinerja_bulanan[]
  target_penilaian    target_penilaian[]
}

model ref_satuan_kinerja {
  id               Int                @id @default(autoincrement())
  nama             String?            @db.VarChar(200)
  created_at       DateTime?          @default(now()) @db.Timestamp(6)
  updated_at       DateTime?          @db.Timestamp(6)
  target_penilaian target_penilaian[]
}

model target_penilaian {
  id                    Int                 @id @default(autoincrement())
  pekerjaan             String?
  ref_satuan_kinerja_id Int?
  kuantitas             Int?
  id_penilaian          Int?
  created_at            DateTime?           @default(now()) @db.Timestamp(6)
  updated_at            DateTime?           @db.Timestamp(6)
  id_ptt                Int?
  penilaian             penilaian?          @relation(fields: [id_penilaian], references: [id], onDelete: Cascade)
  ref_satuan_kinerja    ref_satuan_kinerja? @relation(fields: [ref_satuan_kinerja_id], references: [id], onDelete: Cascade)
  kinerja_bulanan       kinerja_bulanan[]
}

model comments {
  id                     String                   @id @default(cuid())
  nama                   String?
  department             String?
  status                 String?
  usia                   String?
  avatar                 String?
  comment                String?
  user_custom_id         String?
  user_type              String?
  comments_tags          comments_tags[]
  likes                  Int                      @default(0)
  dislikes               Int                      @default(0)
  parent_id              String?
  parent                 comments?                @relation("SubComments", fields: [parent_id], references: [id], onDelete: Cascade)
  children               comments[]               @relation("SubComments")
  created_at             DateTime?                @default(now()) @db.Timestamp(6)
  updated_at             DateTime?                @db.Timestamp(6)
  comments_mentioned     comments_mentioned[]
  comments_notifications comments_notifications[]
  comments_likes         comments_likes[]
}

model comments_likes {
  comment_id     String
  user_custom_id String
  user_name      String?
  avatar         String?
  value          Int?
  comments       comments? @relation(fields: [comment_id], references: [id], onDelete: Cascade)

  @@id([comment_id, user_custom_id])
}

model comments_mentioned {
  comment_id     String
  user_custom_id String
  comments       comments  @relation(fields: [comment_id], references: [id], onDelete: Cascade)
  created_at     DateTime? @default(now()) @db.Timestamp(6)
  updated_at     DateTime? @db.Timestamp(6)

  @@id([comment_id, user_custom_id])
}

model comments_notifications {
  id            String    @id @default(cuid())
  comment_id    String?
  sender        String?
  receiver      String?
  sender_name   String?
  receiver_name String?
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  updated_at    DateTime? @db.Timestamp(6)
  comments      comments? @relation(fields: [comment_id], references: [id], onDelete: Cascade)
}

model tags {
  id            Int             @id @default(autoincrement())
  name          String?
  created_at    DateTime?       @default(now()) @db.Timestamp(6)
  updated_at    DateTime?       @db.Timestamp(6)
  comments_tags comments_tags[]
}

model comments_tags {
  comment_id String
  tag_id     Int
  comments   comments? @relation(fields: [comment_id], references: [id], onDelete: Cascade)
  tags       tags?     @relation(fields: [tag_id], references: [id], onDelete: Cascade)

  @@id([comment_id, tag_id])
}

model votes {
  id         String     @id @default(cuid())
  title      String?
  is_end     Boolean    @default(false)
  end_date   DateTime?  @db.Timestamp(6)
  created_at DateTime?  @default(now()) @db.Timestamp(6)
  updated_at DateTime?  @db.Timestamp(6)
  subvotes   subvotes[]
}

model subvotes {
  id            String    @id @default(cuid())
  subvote_title String
  vote_id       String
  votes         votes     @relation(fields: [vote_id], references: [id], onDelete: Cascade)
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  updated_at    DateTime? @db.Timestamp(6)

  subvotes_count subvotes_count[]
}

model subvotes_count {
  subvote_id     String
  user_custom_id String

  subvotes subvotes @relation(fields: [subvote_id], references: [id], onDelete: Cascade)

  @@id([subvote_id, user_custom_id])
}

model feedbacks {
  user_custom_id String
  date           DateTime  @db.Date
  descriptiom    String?
  created_at     DateTime? @default(now()) @db.Timestamp(6)
  updated_at     DateTime? @db.Timestamp(6)

  @@id([user_custom_id, date])
}

// reddits
model discussions_posts {
  id                 String               @id @default(cuid())
  parent_id          String?
  title              String?
  content            String?
  link               String?
  user_custom_id     String?
  username           String?
  avatar             String?
  pic                String?
  status             String?
  image_list         Json?
  type               String?
  votes              Int?                 @default(0)
  created_at         DateTime?            @default(now()) @db.Timestamp(6)
  discussions_votes  discussions_votes[]
  discussions_ranks  discussions_ranks[]
  discussions_rights discussions_rights[]
}

model discussions_votes {
  discussion_post_id String
  user_custom_id     String
  username           String?
  avatar             String?
  vlag               Int?

  discussions_posts discussions_posts @relation(fields: [discussion_post_id], references: [id], onDelete: Cascade)

  @@id([discussion_post_id, user_custom_id])
}

model discussions_ranks {
  discussion_post_id String
  hot                Int?   @default(0)
  new                Int?   @default(0)
  raising            Int?   @default(0)
  controversial      Int?   @default(0)
  top                Int?   @default(0)

  discussions_posts discussions_posts @relation(fields: [discussion_post_id], references: [id], onDelete: Cascade)
  @@id([discussion_post_id])
}

model discussions_rights {
  id                      String  @id @default(cuid())
  discussion_post_id      String
  property                String?
  user_custom_id          String?
  username                String?
  avatar                  String?
  assigned_user_custom_id String

  discussions_posts discussions_posts @relation(fields: [discussion_post_id], references: [id], onDelete: Cascade)
}
